
record(stringin, "CrS-C3S:Ctrl-PLC-01:ModVersionR") {
	field(DISP,	"1")
	field(VAL,	"$(MODVERSION=N/A)")
	field(PINI,	"YES")
}

record(stringin, "CrS-C3S:Ctrl-PLC-01:PLCFCommitR") {
	field(DISP,	"1")
#57d6ccfb5b3398d4eabe349cb1a1fa5fd455a1e1
	field(VAL,	"57d6ccfb5b3398d4eabe349cb1a1fa5fd455a1e")
	field(PINI,	"YES")
	info("plcf_commit", "57d6ccfb5b3398d4eabe349cb1a1fa5fd455a1e1")
}

#########################################################
########## EPICS <-> PLC connection management ##########
#########################################################
record(bi, "CrS-C3S:Ctrl-PLC-01:ModbusConnectedR") {
	field(DESC,	"Shows if the MODBUS channel connected")
	field(ONAM,	"Connected")
	field(ZNAM,	"Disconnected")
	field(ZSV,      "MAJOR")
	field(VAL,	"1")
	field(PINI,	"YES")
	field(FLNK,	"CrS-C3S:Ctrl-PLC-01:CommsHashToPLCS")
}
record(bi, "CrS-C3S:Ctrl-PLC-01:S7ConnectedR") {
	field(DESC,	"Shows if the S7 channel is connected")
	field(ONAM,	"Connected")
	field(ZNAM,	"Disconnected")
	field(ZSV,      "MAJOR")
	field(VAL,	"1")
	field(PINI,	"YES")
}
record(calcout, "CrS-C3S:Ctrl-PLC-01:iCalcConn") {
	field(INPA,	"CrS-C3S:Ctrl-PLC-01:S7ConnectedR CP")
	field(INPB,	"CrS-C3S:Ctrl-PLC-01:ModbusConnectedR CP")
	field(CALC,	"A && B")
	field(OUT,	"CrS-C3S:Ctrl-PLC-01:ConnectedR PP")
}
record(bi, "CrS-C3S:Ctrl-PLC-01:ConnectedR") {
	field(DESC,	"Shows if the PLC is connected")
	field(ONAM,	"Connected")
	field(ZNAM,	"Disconnected")
	field(ZSV,      "MAJOR")
}
record(bi, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR") {
	field(DESC,	"Shows if the comms hash is correct")
	field(ONAM,	"Correct")
	field(ZNAM,	"Incorrect")
	field(ZSV,      "MAJOR")
}
record(bi, "CrS-C3S:Ctrl-PLC-01:AliveR") {
	alias("CrS-C3S:Ctrl-PLC-01:CommsOK")
	field(DESC,	"Shows if the PLC is sending heartbeats")
	field(ONAM,	"Alive")
	field(ZNAM,	"Not responding")
	field(ZSV,      "MAJOR")
}
record(calcout, "CrS-C3S:Ctrl-PLC-01:iCheckHash") {
	field(INPA,	"CrS-C3S:Ctrl-PLC-01:iCommsHashToPLC")
	field(INPB,	"CrS-C3S:Ctrl-PLC-01:CommsHashFromPLCR")
	field(INPC,	"CrS-C3S:Ctrl-PLC-01:CommsHashFromPLCR.STAT")
	field(CALC,	"A == B && C == 0")
	field(OOPT,	"On Change")
	field(OUT,	"CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR PP")
}
record(bi, "CrS-C3S:Ctrl-PLC-01:iOne") {
	field(DISP,	"1")
	field(PINI,	"YES")
	field(VAL,	"1")
}
record(bo, "CrS-C3S:Ctrl-PLC-01:iGotHeartbeat") {
	field(DOL,	"CrS-C3S:Ctrl-PLC-01:iOne")
	field(OMSL,	"closed_loop")
	field(OUT,	"CrS-C3S:Ctrl-PLC-01:iKickAlive PP")
}
record(bo, "CrS-C3S:Ctrl-PLC-01:iKickAlive") {
	field(HIGH,	"5")
	field(OUT,	"CrS-C3S:Ctrl-PLC-01:AliveR PP")
}

########################################################
########## EPICS -> PLC comms management data ##########
########################################################
record(ao, "CrS-C3S:Ctrl-PLC-01:iCommsHashToPLC") {
	field(DISP,	"1")
	field(PINI,	"YES")
	field(VAL,	"-1403542218")
}
record(ao, "CrS-C3S:Ctrl-PLC-01:CommsHashToPLCS") {
	field(DESC,	"Sends comms hash to PLC")
	field(OMSL,	"closed_loop")
	field(DOL,	"CrS-C3S:Ctrl-PLC-01:iCommsHashToPLC")
	field(DISV,	"0")
	field(SDIS,	"CrS-C3S:Ctrl-PLC-01:ConnectedR")
}
record(calc, "CrS-C3S:Ctrl-PLC-01:iHeartbeatToPLC") {
	field(SCAN,	"1 second")
	field(INPA,	"CrS-C3S:Ctrl-PLC-01:iHeartbeatToPLC.VAL")
	field(CALC,	"(A >= 32000)? 0 : A + 1")
	field(FLNK,	"CrS-C3S:Ctrl-PLC-01:HeartbeatToPLCS")
	field(DISV,	"0")
	field(SDIS,	"CrS-C3S:Ctrl-PLC-01:ConnectedR")
}
record(ao, "CrS-C3S:Ctrl-PLC-01:HeartbeatToPLCS") {
	field(DESC,	"Sends heartbeat to PLC")
	field(OMSL,	"closed_loop")
	field(DOL,	"CrS-C3S:Ctrl-PLC-01:iHeartbeatToPLC.VAL")
	field(OIF,	"Full")
	field(DRVL,	"0")
	field(DRVH,	"32000")
}

########################################################
########## PLC -> EPICS comms management data ##########
########################################################
record(ai, "CrS-C3S:Ctrl-PLC-01:CommsHashFromPLCR") {
	field(DESC,	"Comms hash from PLC")
	field(SCAN,	"1 second")
	field(PINI,	"YES")
	field(VAL,	"-1403542218")
	field(FLNK,	"CrS-C3S:Ctrl-PLC-01:iCheckHash")
}
record(ai, "CrS-C3S:Ctrl-PLC-01:HeartbeatFromPLCR") {
	field(DESC,	"Heartbeat from PLC")
	field(INP,	"CrS-C3S:Ctrl-PLC-01:iHeartbeatToPLC.VAL CP")
	field(FLNK,	"CrS-C3S:Ctrl-PLC-01:iGotHeartbeat")
}

########################################################
################# Test management data #################
########################################################
record(ao, "CrS-C3S:Ctrl-PLC-01:FixHashS") {
	field(DESC,	"Make HASH correct")
	field(OMSL,	"closed_loop")
	field(DOL,	"CrS-C3S:Ctrl-PLC-01:iCommsHashToPLC")
	field(OUT,	"CrS-C3S:Ctrl-PLC-01:CommsHashFromPLCR PP")
}

record(bo, "CrS-C3S:Ctrl-PLC-01:RuinHashS") {
	field(DESC,	"Make HASH incorrect")
	field(FLNK,	"CrS-C3S:Ctrl-PLC-01:iRuinHash")
}
record(calcout, "CrS-C3S:Ctrl-PLC-01:iRuinHash") {
	field(DESC,	"Make HASH incorrect")
	field(INPA,	"CrS-C3S:Ctrl-PLC-01:iCommsHashToPLC")
	field(CALC,	"A * -1")
	field(OUT,	"CrS-C3S:Ctrl-PLC-01:CommsHashFromPLCR PP")
}

##########
########## CrS-C3S:Ctrl-PLC-01 ##########
##########
##########

###################################### SHC Systems ########################################
##############################  Safety Helium Collector System   ##########################
##                         			   PLC Control
##
##############################         Version: 1.0           #############################
#Author:  Saeed Haghtalab
#Date:    17-07-2018
#Version: v1.0


############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## CrS-C3S:Ctrl-PLC-01 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",                PV_ONAM="True",           PV_ZNAM="False")
record(bi, "CrS-C3S:Ctrl-PLC-01:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",                  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "CrS-C3S:Ctrl-PLC-01:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_AutoBeam",         PV_DESC="Operation Mode Auto Beam",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "CrS-C3S:Ctrl-PLC-01:OpMode_AutoBeam")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto Beam")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "OpMode_AutoBeam")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_AutoMaint",        PV_DESC="Operation Mode Auto Maintenance",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "CrS-C3S:Ctrl-PLC-01:OpMode_AutoMaint")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto Maintenance")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "OpMode_AutoMaint")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Lock_OpMode",             PV_DESC="Lock Operation Mode",                  PV_ONAM="Locked",         PV_ZNAM="Unlocked")
record(bi, "CrS-C3S:Ctrl-PLC-01:Lock_OpMode")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Lock Operation Mode")
	field(ONAM, "Locked")
	field(ZNAM, "Unlocked")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "Lock_OpMode")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("GlobalAlarm",             PV_DESC="Global Alarm",                         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "CrS-C3S:Ctrl-PLC-01:GlobalAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Global Alarm")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "GlobalAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Simulation",              PV_DESC="Simulation Mode",                      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "CrS-C3S:Ctrl-PLC-01:Simulation")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Simulation Mode")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "Simulation")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("GroupAlarmsCount",         "INT",                                          PV_DESC="Number of Group Alarms")
record(ai, "CrS-C3S:Ctrl-PLC-01:GroupAlarmsCount")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Number of Group Alarms")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "GroupAlarmsCount")
	info(autosaveFields_pass0, "VAL")
}




############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## CrS-C3S:Ctrl-PLC-01 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_LockOpModeOn",        PV_DESC="CMD: Turn Mode-Lock ON")
record(bo, "CrS-C3S:Ctrl-PLC-01:Cmd_LockOpModeOn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Turn Mode-Lock ON")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "Cmd_LockOpModeOn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_LockOpModeOff",       PV_DESC="CMD: Turn Mode-Lock OFF")
record(bo, "CrS-C3S:Ctrl-PLC-01:Cmd_LockOpModeOff")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Turn Mode-Lock OFF")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "Cmd_LockOpModeOff")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_OpModeManual",        PV_DESC="CMD: Manual Mode Operation")
record(bo, "CrS-C3S:Ctrl-PLC-01:Cmd_OpModeManual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode Operation")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "Cmd_OpModeManual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_OpModeAuto",          PV_DESC="CMD: Auto Mode Operation")
record(bo, "CrS-C3S:Ctrl-PLC-01:Cmd_OpModeAuto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode Operation")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "Cmd_OpModeAuto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_OpAutoBeam",          PV_DESC="CMD: Auto Beam Mode")
record(bo, "CrS-C3S:Ctrl-PLC-01:Cmd_OpAutoBeam")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Beam Mode")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "Cmd_OpAutoBeam")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_OpAutoMaint",         PV_DESC="CMD: Auto Maintenance Mode")
record(bo, "CrS-C3S:Ctrl-PLC-01:Cmd_OpAutoMaint")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Maintenance Mode")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "Cmd_OpAutoMaint")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_AutoAll",             PV_DESC="CMD: Change all valves to Auto mode")
record(bo, "CrS-C3S:Ctrl-PLC-01:Cmd_AutoAll")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Change all valves to Auto mode")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "Cmd_AutoAll")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_GlobalAlarmAck",      PV_DESC="CMD: Acknowledge all valve's Alarm")
record(bo, "CrS-C3S:Ctrl-PLC-01:Cmd_GlobalAlarmAck")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge all valve's Alarm")
	info("plc_datablock", "DEV_CrS-C3S:Ctrl-PLC-01_iDB")
	info("plc_variable", "Cmd_GlobalAlarmAck")
	info(autosaveFields_pass0, "VAL")
}




##########
########## HBL-010SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-010SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-010SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-010SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-010SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-010SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-010SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-010SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-010SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-010SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-010SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-010SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-010SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-010SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-010SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-010SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-010SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-010SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-010SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-010SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-010SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-010SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-010SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-010SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-010SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-010SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-010SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-010SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-010SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-010SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-010SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-010SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-010SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-010SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-010SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-010SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-010SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-010SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-010SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-010SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-010SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-010SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-010SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-010SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-010SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-010SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-010SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-010SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-010SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-010SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-010SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-010SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-010SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-010SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-010SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-010SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-010SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-010SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-010SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-010SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-010SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-010SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-010SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-020SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-020SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-020SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-020SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-020SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-020SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-020SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-020SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-020SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-020SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-020SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-020SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-020SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-020SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-020SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-020SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-020SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-020SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-020SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-020SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-020SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-020SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-020SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-020SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-020SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-020SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-020SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-020SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-020SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-020SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-020SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-020SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-020SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-020SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-020SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-020SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-020SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-020SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-020SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-020SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-020SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-020SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-020SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-020SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-020SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-020SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-020SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-020SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-020SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-020SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-020SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-020SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-020SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-020SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-020SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-020SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-020SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-020SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-020SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-020SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-020SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-020SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-020SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-030SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-030SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-030SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-030SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-030SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-030SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-030SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-030SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-030SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-030SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-030SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-030SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-030SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-030SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-030SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-030SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-030SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-030SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-030SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-030SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-030SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-030SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-030SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-030SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-030SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-030SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-030SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-030SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-030SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-030SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-030SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-030SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-030SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-030SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-030SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-030SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-030SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-030SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-030SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-030SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-030SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-030SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-030SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-030SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-030SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-030SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-030SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-030SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-030SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-030SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-030SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-030SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-030SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-030SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-030SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-030SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-030SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-030SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-030SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-030SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-030SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-030SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-030SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-040SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-040SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-040SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-040SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-040SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-040SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-040SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-040SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-040SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-040SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-040SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-040SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-040SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-040SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-040SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-040SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-040SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-040SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-040SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-040SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-040SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-040SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-040SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-040SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-040SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-040SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-040SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-040SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-040SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-040SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-040SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-040SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-040SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-040SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-040SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-040SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-040SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-040SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-040SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-040SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-040SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-040SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-040SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-040SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-040SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-040SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-040SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-040SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-040SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-040SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-040SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-040SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-040SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-040SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-040SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-040SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-040SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-040SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-040SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-040SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-040SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-040SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-040SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-050SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-050SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-050SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-050SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-050SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-050SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-050SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-050SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-050SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-050SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-050SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-050SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-050SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-050SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-050SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-050SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-050SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-050SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-050SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-050SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-050SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-050SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-050SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-050SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-050SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-050SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-050SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-050SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-050SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-050SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-050SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-050SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-050SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-050SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-050SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-050SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-050SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-050SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-050SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-050SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-050SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-050SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-050SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-050SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-050SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-050SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-050SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-050SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-050SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-050SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-050SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-050SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-050SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-050SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-050SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-050SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-050SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-050SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-050SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-050SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-050SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-050SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-050SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-060SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-060SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-060SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-060SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-060SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-060SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-060SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-060SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-060SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-060SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-060SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-060SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-060SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-060SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-060SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-060SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-060SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-060SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-060SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-060SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-060SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-060SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-060SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-060SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-060SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-060SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-060SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-060SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-060SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-060SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-060SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-060SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-060SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-060SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-060SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-060SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-060SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-060SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-060SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-060SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-060SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-060SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-060SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-060SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-060SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-060SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-060SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-060SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-060SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-060SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-060SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-060SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-060SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-060SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-060SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-060SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-060SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-060SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-060SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-060SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-060SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-060SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-060SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-070SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-070SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-070SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-070SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-070SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-070SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-070SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-070SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-070SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-070SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-070SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-070SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-070SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-070SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-070SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-070SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-070SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-070SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-070SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-070SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-070SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-070SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-070SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-070SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-070SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-070SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-070SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-070SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-070SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-070SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-070SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-070SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-070SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-070SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-070SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-070SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-070SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-070SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-070SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-070SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-070SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-070SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-070SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-070SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-070SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-070SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-070SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-070SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-070SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-070SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-070SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-070SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-070SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-070SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-070SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-070SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-070SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-070SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-070SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-070SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-070SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-070SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-070SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-080SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-080SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-080SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-080SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-080SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-080SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-080SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-080SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-080SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-080SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-080SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-080SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-080SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-080SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-080SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-080SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-080SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-080SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-080SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-080SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-080SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-080SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-080SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-080SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-080SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-080SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-080SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-080SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-080SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-080SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-080SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-080SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-080SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-080SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-080SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-080SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-080SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-080SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-080SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-080SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-080SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-080SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-080SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-080SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-080SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-080SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-080SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-080SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-080SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-080SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-080SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-080SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-080SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-080SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-080SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-080SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-080SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-080SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-080SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-080SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-080SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-080SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-080SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-090SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-090SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-090SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-090SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-090SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-090SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-090SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-090SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-090SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-090SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-090SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-090SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-090SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-090SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-090SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-090SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-090SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-090SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-090SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-090SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-090SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-090SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-090SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-090SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-090SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-090SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-090SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-090SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-090SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-090SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-090SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-090SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-090SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-090SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-090SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-090SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-090SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-090SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-090SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-090SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-090SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-090SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-090SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-090SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-090SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-090SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-090SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-090SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-090SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-090SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-090SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-090SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-090SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-090SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-090SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-090SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-090SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-090SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-090SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-090SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-090SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-090SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-090SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-100SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-100SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-100SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-100SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-100SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-100SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-100SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-100SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-100SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-100SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-100SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-100SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-100SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-100SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-100SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-100SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-100SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-100SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-100SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-100SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-100SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-100SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-100SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-100SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-100SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-100SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-100SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-100SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-100SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-100SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-100SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-100SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-100SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-100SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-100SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-100SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-100SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-100SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-100SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-100SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-100SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-100SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-100SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-100SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-100SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-100SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-100SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-100SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-100SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-100SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-100SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-100SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-100SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-100SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-100SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-100SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-100SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-100SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-100SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-100SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-100SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-100SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-100SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-110SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-110SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-110SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-110SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-110SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-110SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-110SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-110SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-110SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-110SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-110SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-110SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-110SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-110SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-110SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-110SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-110SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-110SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-110SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-110SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-110SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-110SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-110SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-110SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-110SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-110SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-110SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-110SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-110SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-110SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-110SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-110SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-110SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-110SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-110SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-110SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-110SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-110SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-110SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-110SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-110SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-110SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-110SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-110SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-110SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-110SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-110SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-110SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-110SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-110SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-110SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-110SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-110SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-110SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-110SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-110SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-110SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-110SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-110SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-110SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-110SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-110SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-110SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-120SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-120SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-120SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-120SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-120SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-120SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-120SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-120SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-120SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-120SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-120SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-120SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-120SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-120SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-120SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-120SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-120SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-120SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-120SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-120SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-120SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-120SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-120SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-120SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-120SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-120SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-120SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-120SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-120SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-120SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-120SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-120SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-120SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-120SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-120SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-120SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-120SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-120SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-120SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-120SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-120SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-120SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-120SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-120SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-120SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-120SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-120SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-120SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-120SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-120SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-120SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-120SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-120SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-120SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-120SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-120SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-120SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-120SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-120SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-120SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-120SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-120SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-120SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-130SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-130SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-130SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-130SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-130SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-130SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-130SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-130SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-130SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-130SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-130SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-130SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-130SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-130SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-130SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-130SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-130SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-130SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-130SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-130SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-130SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-130SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-130SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-130SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-130SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-130SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-130SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-130SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-130SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-130SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-130SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-130SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-130SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-130SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-130SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-130SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-130SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-130SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-130SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-130SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-130SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-130SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-130SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-130SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-130SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-130SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-130SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-130SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-130SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-130SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-130SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-130SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-130SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-130SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-130SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-130SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-130SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-130SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-130SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-130SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-130SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-130SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-130SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-140SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-140SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-140SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-140SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-140SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-140SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-140SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-140SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-140SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-140SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-140SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-140SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-140SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-140SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-140SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-140SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-140SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-140SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-140SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-140SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-140SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-140SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-140SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-140SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-140SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-140SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-140SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-140SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-140SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-140SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-140SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-140SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-140SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-140SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-140SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-140SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-140SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-140SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-140SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-140SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-140SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-140SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-140SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-140SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-140SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-140SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-140SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-140SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-140SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-140SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-140SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-140SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-140SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-140SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-140SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-140SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-140SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-140SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-140SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-140SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-140SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-140SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-140SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-140SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-150SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-150SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-150SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-150SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-150SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-150SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-150SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-150SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-150SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-150SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-150SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-150SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-150SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-150SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-150SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-150SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-150SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-150SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-150SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-150SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-150SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-150SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-150SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-150SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-150SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-150SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-150SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-150SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-150SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-150SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-150SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-150SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-150SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-150SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-150SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-150SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-150SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-150SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-150SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-150SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-150SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-150SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-150SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-150SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-150SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-150SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-150SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-150SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-150SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-150SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-150SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-150SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-150SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-150SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-150SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-150SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-150SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-150SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-150SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-150SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-150SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-150SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-150SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-150SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-160SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-160SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-160SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-160SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-160SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-160SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-160SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-160SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-160SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-160SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-160SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-160SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-160SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-160SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-160SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-160SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-160SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-160SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-160SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-160SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-160SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-160SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-160SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-160SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-160SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-160SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-160SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-160SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-160SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-160SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-160SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-160SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-160SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-160SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-160SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-160SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-160SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-160SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-160SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-160SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-160SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-160SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-160SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-160SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-160SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-160SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-160SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-160SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-160SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-160SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-160SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-160SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-160SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-160SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-160SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-160SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-160SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-160SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-160SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-160SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-160SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-160SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-160SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-160SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-170SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-170SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-170SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-170SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-170SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-170SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-170SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-170SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-170SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-170SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-170SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-170SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-170SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-170SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-170SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-170SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-170SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-170SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-170SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-170SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-170SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-170SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-170SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-170SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-170SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-170SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-170SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-170SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-170SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-170SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-170SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-170SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-170SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-170SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-170SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-170SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-170SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-170SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-170SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-170SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-170SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-170SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-170SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-170SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-170SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-170SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-170SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-170SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-170SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-170SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-170SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-170SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-170SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-170SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-170SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-170SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-170SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-170SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-170SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-170SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-170SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-170SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-170SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-170SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-180SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-180SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-180SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-180SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-180SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-180SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-180SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-180SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-180SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-180SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-180SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-180SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-180SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-180SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-180SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-180SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-180SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-180SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-180SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-180SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-180SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-180SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-180SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-180SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-180SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-180SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-180SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-180SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-180SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-180SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-180SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-180SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-180SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-180SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-180SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-180SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-180SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-180SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-180SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-180SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-180SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-180SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-180SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-180SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-180SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-180SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-180SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-180SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-180SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-180SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-180SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-180SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-180SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-180SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-180SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-180SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-180SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-180SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-180SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-180SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-180SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-180SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-180SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-180SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-190SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-190SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-190SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-190SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-190SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-190SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-190SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-190SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-190SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-190SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-190SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-190SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-190SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-190SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-190SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-190SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-190SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-190SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-190SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-190SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-190SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-190SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-190SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-190SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-190SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-190SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-190SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-190SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-190SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-190SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-190SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-190SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-190SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-190SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-190SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-190SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-190SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-190SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-190SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-190SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-190SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-190SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-190SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-190SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-190SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-190SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-190SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-190SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-190SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-190SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-190SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-190SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-190SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-190SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-190SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-190SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-190SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-190SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-190SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-190SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-190SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-190SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-190SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-190SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-200SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-200SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-200SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-200SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-200SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-200SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-200SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-200SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-200SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-200SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-200SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-200SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-200SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-200SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-200SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-200SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-200SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-200SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-200SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-200SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-200SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-200SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-200SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-200SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-200SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-200SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-200SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-200SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-200SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-200SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-200SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-200SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-200SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-200SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-200SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-200SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-200SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-200SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-200SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-200SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-200SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-200SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-200SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-200SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-200SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-200SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-200SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-200SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-200SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-200SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-200SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-200SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-200SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-200SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-200SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-200SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-200SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-200SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-200SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-200SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-200SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-200SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-200SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-200SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## HBL-210SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-210SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-210SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-210SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-210SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-210SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-210SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-210SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-210SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-210SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-210SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-210SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-210SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-210SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-210SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-210SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-210SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-210SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-210SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-210SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-210SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-210SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-210SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-210SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-210SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-210SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-210SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-210SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-210SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "HBL-210SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "HBL-210SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## HBL-210SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## HBL-210SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "HBL-210SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "HBL-210SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "HBL-210SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "HBL-210SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "HBL-210SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "HBL-210SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "HBL-210SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-210SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "HBL-210SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "HBL-210SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "HBL-210SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "HBL-210SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "HBL-210SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "HBL-210SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "HBL-210SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## HBL-210SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "HBL-210SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "HBL-210SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "HBL-210SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "HBL-210SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "HBL-210SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "HBL-210SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "HBL-210SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "HBL-210SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## HBL-210SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "HBL-210SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "HBL-210SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_HBL-210SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "HBL-210SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "HBL-210SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "HBL-210SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## MBL-010SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-010SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-010SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-010SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-010SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-010SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-010SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-010SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-010SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-010SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-010SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-010SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-010SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-010SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-010SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-010SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-010SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-010SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-010SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-010SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-010SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-010SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-010SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-010SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-010SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-010SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-010SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-010SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-010SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "MBL-010SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "MBL-010SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## MBL-010SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-010SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-010SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-010SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-010SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-010SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-010SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-010SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-010SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-010SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-010SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-010SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-010SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-010SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-010SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-010SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-010SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-010SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-010SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-010SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-010SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-010SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-010SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-010SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-010SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-010SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-010SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-010SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-010SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-010SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "MBL-010SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "MBL-010SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## MBL-020SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-020SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-020SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-020SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-020SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-020SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-020SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-020SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-020SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-020SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-020SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-020SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-020SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-020SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-020SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-020SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-020SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-020SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-020SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-020SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-020SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-020SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-020SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-020SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-020SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-020SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-020SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-020SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-020SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "MBL-020SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "MBL-020SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## MBL-020SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-020SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-020SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-020SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-020SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-020SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-020SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-020SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-020SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-020SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-020SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-020SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-020SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-020SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-020SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-020SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-020SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-020SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-020SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-020SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-020SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-020SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-020SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-020SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-020SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-020SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-020SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-020SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-020SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-020SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "MBL-020SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "MBL-020SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## MBL-030SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-030SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-030SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-030SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-030SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-030SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-030SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-030SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-030SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-030SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-030SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-030SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-030SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-030SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-030SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-030SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-030SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-030SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-030SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-030SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-030SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-030SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-030SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-030SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-030SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-030SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-030SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-030SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-030SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "MBL-030SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "MBL-030SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## MBL-030SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-030SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-030SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-030SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-030SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-030SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-030SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-030SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-030SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-030SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-030SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-030SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-030SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-030SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-030SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-030SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-030SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-030SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-030SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-030SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-030SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-030SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-030SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-030SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-030SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-030SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-030SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-030SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-030SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-030SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "MBL-030SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "MBL-030SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## MBL-040SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-040SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-040SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-040SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-040SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-040SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-040SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-040SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-040SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-040SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-040SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-040SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-040SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-040SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-040SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-040SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-040SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-040SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-040SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-040SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-040SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-040SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-040SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-040SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-040SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-040SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-040SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-040SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-040SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "MBL-040SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "MBL-040SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## MBL-040SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-040SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-040SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-040SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-040SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-040SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-040SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-040SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-040SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-040SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-040SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-040SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-040SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-040SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-040SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-040SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-040SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-040SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-040SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-040SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-040SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-040SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-040SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-040SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-040SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-040SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-040SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-040SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-040SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-040SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "MBL-040SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "MBL-040SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## MBL-050SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-050SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-050SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-050SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-050SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-050SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-050SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-050SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-050SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-050SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-050SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-050SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-050SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-050SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-050SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-050SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-050SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-050SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-050SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-050SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-050SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-050SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-050SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-050SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-050SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-050SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-050SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-050SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-050SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "MBL-050SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "MBL-050SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## MBL-050SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-050SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-050SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-050SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-050SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-050SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-050SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-050SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-050SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-050SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-050SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-050SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-050SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-050SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-050SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-050SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-050SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-050SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-050SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-050SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-050SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-050SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-050SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-050SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-050SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-050SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-050SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-050SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-050SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-050SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "MBL-050SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "MBL-050SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## MBL-060SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-060SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-060SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-060SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-060SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-060SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-060SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-060SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-060SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-060SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-060SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-060SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-060SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-060SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-060SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-060SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-060SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-060SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-060SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-060SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-060SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-060SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-060SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-060SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-060SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-060SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-060SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-060SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-060SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "MBL-060SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "MBL-060SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## MBL-060SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-060SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-060SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-060SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-060SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-060SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-060SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-060SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-060SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-060SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-060SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-060SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-060SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-060SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-060SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-060SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-060SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-060SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-060SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-060SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-060SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-060SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-060SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-060SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-060SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-060SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-060SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-060SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-060SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-060SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "MBL-060SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "MBL-060SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## MBL-070SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-070SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-070SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-070SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-070SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-070SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-070SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-070SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-070SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-070SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-070SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-070SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-070SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-070SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-070SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-070SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-070SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-070SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-070SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-070SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-070SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-070SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-070SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-070SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-070SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-070SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-070SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-070SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-070SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "MBL-070SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "MBL-070SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## MBL-070SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-070SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-070SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-070SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-070SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-070SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-070SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-070SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-070SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-070SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-070SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-070SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-070SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-070SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-070SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-070SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-070SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-070SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-070SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-070SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-070SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-070SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-070SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-070SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-070SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-070SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-070SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-070SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-070SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-070SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "MBL-070SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "MBL-070SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## MBL-080SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-080SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-080SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-080SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-080SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-080SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-080SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-080SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-080SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-080SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-080SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-080SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-080SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-080SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-080SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-080SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-080SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-080SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-080SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-080SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-080SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-080SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-080SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-080SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-080SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-080SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-080SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-080SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-080SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "MBL-080SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "MBL-080SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## MBL-080SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-080SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-080SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-080SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-080SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-080SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-080SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-080SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-080SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-080SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-080SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-080SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-080SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-080SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-080SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-080SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-080SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-080SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-080SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-080SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-080SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-080SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-080SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-080SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-080SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-080SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-080SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-080SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-080SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-080SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "MBL-080SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "MBL-080SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## MBL-090SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-090SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-090SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-090SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-090SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-090SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-090SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-090SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-090SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-090SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-090SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-090SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-090SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-090SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-090SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-090SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-090SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-090SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-090SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-090SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-090SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-090SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-090SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-090SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-090SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-090SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-090SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-090SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-090SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "MBL-090SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "MBL-090SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## MBL-090SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## MBL-090SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "MBL-090SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "MBL-090SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "MBL-090SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "MBL-090SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "MBL-090SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "MBL-090SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "MBL-090SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-090SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "MBL-090SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "MBL-090SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "MBL-090SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "MBL-090SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "MBL-090SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "MBL-090SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "MBL-090SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## MBL-090SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "MBL-090SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "MBL-090SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "MBL-090SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "MBL-090SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "MBL-090SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "MBL-090SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "MBL-090SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "MBL-090SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## MBL-090SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "MBL-090SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "MBL-090SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_MBL-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "MBL-090SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "MBL-090SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "MBL-090SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-010SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-010SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-010SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-010SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-010SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-010SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-010SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-010SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-010SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-010SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-010SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-010SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-010SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-010SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-010SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-010SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-010SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-010SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-010SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-010SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-010SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-010SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-010SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-010SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-010SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-010SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-010SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-010SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-010SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-010SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-010SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-010SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-010SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-010SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-010SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-010SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-010SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-010SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-010SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-010SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-010SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-010SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-010SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-010SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-010SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-010SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-010SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-010SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-010SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-010SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-010SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-010SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-010SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-010SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-010SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-010SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-010SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-010SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-010SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-010SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-010SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-010SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-010SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-010SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-020SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-020SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-020SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-020SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-020SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-020SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-020SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-020SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-020SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-020SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-020SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-020SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-020SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-020SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-020SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-020SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-020SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-020SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-020SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-020SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-020SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-020SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-020SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-020SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-020SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-020SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-020SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-020SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-020SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-020SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-020SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-020SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-020SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-020SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-020SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-020SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-020SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-020SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-020SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-020SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-020SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-020SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-020SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-020SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-020SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-020SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-020SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-020SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-020SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-020SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-020SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-020SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-020SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-020SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-020SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-020SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-020SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-020SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-020SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-020SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-020SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-020SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-020SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-020SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-030SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-030SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-030SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-030SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-030SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-030SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-030SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-030SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-030SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-030SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-030SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-030SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-030SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-030SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-030SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-030SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-030SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-030SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-030SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-030SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-030SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-030SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-030SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-030SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-030SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-030SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-030SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-030SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-030SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-030SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-030SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-030SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-030SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-030SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-030SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-030SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-030SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-030SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-030SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-030SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-030SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-030SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-030SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-030SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-030SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-030SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-030SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-030SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-030SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-030SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-030SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-030SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-030SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-030SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-030SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-030SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-030SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-030SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-030SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-030SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-030SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-030SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-030SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-030SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-040SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-040SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-040SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-040SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-040SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-040SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-040SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-040SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-040SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-040SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-040SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-040SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-040SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-040SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-040SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-040SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-040SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-040SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-040SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-040SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-040SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-040SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-040SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-040SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-040SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-040SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-040SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-040SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-040SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-040SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-040SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-040SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-040SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-040SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-040SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-040SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-040SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-040SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-040SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-040SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-040SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-040SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-040SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-040SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-040SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-040SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-040SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-040SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-040SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-040SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-040SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-040SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-040SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-040SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-040SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-040SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-040SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-040SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-040SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-040SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-040SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-040SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-040SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-040SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-050SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-050SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-050SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-050SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-050SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-050SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-050SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-050SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-050SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-050SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-050SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-050SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-050SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-050SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-050SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-050SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-050SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-050SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-050SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-050SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-050SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-050SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-050SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-050SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-050SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-050SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-050SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-050SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-050SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-050SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-050SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-050SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-050SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-050SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-050SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-050SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-050SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-050SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-050SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-050SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-050SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-050SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-050SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-050SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-050SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-050SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-050SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-050SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-050SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-050SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-050SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-050SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-050SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-050SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-050SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-050SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-050SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-050SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-050SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-050SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-050SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-050SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-050SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-050SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-060SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-060SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-060SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-060SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-060SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-060SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-060SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-060SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-060SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-060SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-060SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-060SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-060SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-060SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-060SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-060SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-060SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-060SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-060SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-060SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-060SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-060SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-060SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-060SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-060SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-060SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-060SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-060SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-060SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-060SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-060SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-060SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-060SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-060SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-060SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-060SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-060SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-060SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-060SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-060SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-060SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-060SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-060SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-060SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-060SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-060SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-060SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-060SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-060SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-060SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-060SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-060SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-060SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-060SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-060SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-060SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-060SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-060SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-060SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-060SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-060SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-060SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-060SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-060SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-070SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-070SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-070SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-070SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-070SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-070SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-070SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-070SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-070SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-070SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-070SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-070SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-070SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-070SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-070SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-070SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-070SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-070SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-070SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-070SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-070SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-070SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-070SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-070SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-070SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-070SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-070SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-070SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-070SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-070SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-070SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-070SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-070SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-070SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-070SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-070SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-070SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-070SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-070SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-070SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-070SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-070SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-070SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-070SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-070SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-070SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-070SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-070SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-070SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-070SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-070SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-070SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-070SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-070SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-070SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-070SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-070SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-070SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-070SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-070SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-070SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-070SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-070SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-070SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-080SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-080SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-080SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-080SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-080SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-080SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-080SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-080SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-080SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-080SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-080SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-080SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-080SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-080SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-080SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-080SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-080SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-080SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-080SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-080SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-080SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-080SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-080SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-080SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-080SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-080SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-080SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-080SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-080SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-080SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-080SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-080SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-080SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-080SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-080SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-080SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-080SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-080SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-080SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-080SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-080SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-080SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-080SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-080SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-080SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-080SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-080SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-080SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-080SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-080SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-080SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-080SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-080SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-080SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-080SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-080SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-080SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-080SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-080SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-080SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-080SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-080SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-080SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-080SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-090SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-090SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-090SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-090SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-090SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-090SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-090SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-090SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-090SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-090SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-090SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-090SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-090SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-090SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-090SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-090SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-090SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-090SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-090SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-090SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-090SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-090SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-090SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-090SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-090SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-090SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-090SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-090SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-090SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-090SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-090SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-090SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-090SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-090SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-090SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-090SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-090SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-090SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-090SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-090SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-090SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-090SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-090SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-090SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-090SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-090SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-090SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-090SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-090SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-090SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-090SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-090SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-090SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-090SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-090SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-090SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-090SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-090SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-090SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-090SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-090SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-090SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-090SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-090SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-100SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-100SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-100SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-100SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-100SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-100SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-100SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-100SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-100SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-100SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-100SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-100SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-100SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-100SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-100SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-100SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-100SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-100SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-100SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-100SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-100SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-100SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-100SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-100SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-100SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-100SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-100SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-100SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-100SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-100SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-100SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-100SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-100SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-100SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-100SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-100SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-100SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-100SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-100SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-100SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-100SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-100SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-100SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-100SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-100SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-100SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-100SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-100SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-100SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-100SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-100SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-100SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-100SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-100SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-100SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-100SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-100SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-100SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-100SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-100SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-100SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-100SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-100SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-100SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-110SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-110SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-110SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-110SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-110SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-110SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-110SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-110SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-110SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-110SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-110SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-110SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-110SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-110SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-110SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-110SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-110SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-110SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-110SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-110SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-110SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-110SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-110SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-110SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-110SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-110SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-110SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-110SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-110SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-110SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-110SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-110SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-110SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-110SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-110SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-110SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-110SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-110SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-110SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-110SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-110SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-110SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-110SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-110SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-110SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-110SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-110SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-110SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-110SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-110SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-110SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-110SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-110SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-110SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-110SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-110SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-110SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-110SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-110SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-110SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-110SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-110SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-110SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-110SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-120SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-120SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-120SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-120SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-120SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-120SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-120SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-120SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-120SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-120SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-120SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-120SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-120SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-120SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-120SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-120SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-120SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-120SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-120SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-120SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-120SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-120SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-120SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-120SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-120SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-120SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-120SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-120SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-120SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-120SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-120SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-120SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-120SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-120SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-120SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-120SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-120SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-120SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-120SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-120SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-120SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-120SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-120SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-120SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-120SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-120SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-120SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-120SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-120SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-120SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-120SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-120SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-120SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-120SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-120SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-120SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-120SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-120SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-120SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-120SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-120SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-120SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-120SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-120SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}



##########
########## Spk-130SHC:Cryo-PV-55090 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-130SHC:Cryo-PV-55090 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-130SHC:Cryo-PV-55090:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-130SHC:Cryo-PV-55090:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-130SHC:Cryo-PV-55090:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55090:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-130SHC:Cryo-PV-55090:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-130SHC:Cryo-PV-55090:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-130SHC:Cryo-PV-55090:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-130SHC:Cryo-PV-55090:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-130SHC:Cryo-PV-55090:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-130SHC:Cryo-PV-55090:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-130SHC:Cryo-PV-55090:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-130SHC:Cryo-PV-55090:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-130SHC:Cryo-PV-55090:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-130SHC:Cryo-PV-55090:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-130SHC:Cryo-PV-55090:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-130SHC:Cryo-PV-55090 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-130SHC:Cryo-PV-55090:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-130SHC:Cryo-PV-55090:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-130SHC:Cryo-PV-55090:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-130SHC:Cryo-PV-55090:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-130SHC:Cryo-PV-55090:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-130SHC:Cryo-PV-55090:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-130SHC:Cryo-PV-55090:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-130SHC:Cryo-PV-55090:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-130SHC:Cryo-PV-55090 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-130SHC:Cryo-PV-55090:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-130SHC:Cryo-PV-55090:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55090_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-130SHC:Cryo-PV-55090:UploadParametersS") {
	field(LNK1, "Spk-130SHC:Cryo-PV-55090:P_Faceplate_LockID")
	field(LNK2, "Spk-130SHC:Cryo-PV-55090:P_BlockIcon_LockID")
}



##########
########## Spk-130SHC:Cryo-PV-55091 ##########
##########
##########

###################################### Cryo Systems ########################################
##############################  Cryogenics Moderator System   ##############################
##                         CrS-CMS:CRYO: PV - Remote On/Off valve
##
############################         Version: 1.2             ######################################
#Author:  Miklos Boros
#Date:    28-02-2019
#Version: v1.2
#Changes:
#1. Major review,
#2. Indent,  unit standardization
############################         Version: 1.1             ######################################
#Author:  Miklos Boros, Marino Vojneski
#Date:    12-06-2018
#Version: v1.1
#Changes:
#1. Modified Alarm Signal section to be compatible with new format.
############################ Version: 1.0             ######################################
#Author:  Miklos Boros
#Date:    08-01-2018
#Version: v1.0



############################
#STATUS BLOCK
############################
#<<<--- define_status_block()

##########
########## Spk-130SHC:Cryo-PV-55091 PLC   -> EPICS status   ##########
##########

#Operation modes
#<<<--- add_digital("OpMode_Auto",             PV_DESC="Operation Mode Auto",      PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:OpMode_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Auto")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("OpMode_Manual",           PV_DESC="Operation Mode Manual",    PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:OpMode_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Operation Mode Manual")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpMode_Manual")
	info(autosaveFields_pass0, "VAL")
}


#Valve physical states
#<<<--- add_digital("Opened",                  PV_DESC="Valve Opened",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:Opened")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Opened")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opened")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closed",                  PV_DESC="Valve Closed",             PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:Closed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve Closed")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Opening",                 PV_DESC="Valve is opening",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:Opening")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is opening")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Closing",                 PV_DESC="Valve is closing",         PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:Closing")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Valve is closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Moving",                  PV_DESC="Opening OR Closing",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:Moving")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Opening OR Closing")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Moving")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("OpenSolenoid",            PV_DESC="Open Solenoid energized",  PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:OpenSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Open Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpenSolenoid")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("CloseSolenoid",           PV_DESC="Close Solenoid energized", PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:CloseSolenoid")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Close Solenoid energized")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "CloseSolenoid")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_analog("ValveColor",               "INT",                              PV_DESC="BlockIcon valve color")
record(ai, "Spk-130SHC:Cryo-PV-55091:ValveColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon valve color")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ValveColor")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("SolenoidColor",            "INT",                              PV_DESC="BlockIcon solenoid color")
record(ai, "Spk-130SHC:Cryo-PV-55091:SolenoidColor")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "BlockIcon solenoid color")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolenoidColor")
	info(autosaveFields_pass0, "VAL")
}


#Inhibit signals (set by the PLC code, can't be changed by the OPI)
#<<<--- add_digital("Inhibit_Lock",            PV_DESC="Inhibit Locking",          PV_ONAM="InhibitLocking", PV_ZNAM="AllowLocking")
record(bi, "Spk-130SHC:Cryo-PV-55091:Inhibit_Lock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Inhibit Locking")
	field(ONAM, "InhibitLocking")
	field(ZNAM, "AllowLocking")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Inhibit_Lock")
	info(autosaveFields_pass0, "VAL")
}



#for OPI visualisation
#<<<--- add_digital("EnableAutoBtn",           PV_DESC="Enable Auto Button",       PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:EnableAutoBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Auto Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableAutoBtn")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("EnableManualBtn",         PV_DESC="Enable Manual Button",     PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:EnableManualBtn")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Enable Manual Button")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "EnableManualBtn")
	info(autosaveFields_pass0, "VAL")
}


#Locking mechanism
#<<<--- add_digital("DevLocked",               PV_DESC="Device Locked",            PV_ONAM="True",           PV_ZNAM="False")
record(bi, "Spk-130SHC:Cryo-PV-55091:DevLocked")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device Locked")
	field(ONAM, "True")
	field(ZNAM, "False")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "DevLocked")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("Faceplate_LockID",         "DINT",                             PV_DESC="Owner Lock ID")
record(ai, "Spk-130SHC:Cryo-PV-55091:Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Owner Lock ID")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("BlockIcon_LockID",         "DINT",                             PV_DESC="Guest Lock ID")
record(ai, "Spk-130SHC:Cryo-PV-55091:BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Guest Lock ID")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}


#Alarm signals
#<<<--- add_major_alarm("GroupAlarm",          "Group Alarm",                      PV_ZNAM="NominalState")
record(bi, "Spk-130SHC:Cryo-PV-55091:GroupAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Group Alarm")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "GroupAlarm")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Opening_TimeOut",     "Opening Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-130SHC:Cryo-PV-55091:Opening_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Opening Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Opening_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("Closing_TimeOut",     "Closing Time Out",                 PV_ZNAM="NominalState")
record(bi, "Spk-130SHC:Cryo-PV-55091:Closing_TimeOut")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Closing Time Out")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Closing_TimeOut")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_major_alarm("LimitSwitchAlarm",    "Both limit switches hit",          PV_ZNAM="NominalState")
record(bi, "Spk-130SHC:Cryo-PV-55091:LimitSwitchAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(ONAM, "Both limit switches hit")
	field(OSV,  "MAJOR")
	field(ZNAM, "NominalState")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "LimitSwitchAlarm")
	info(autosaveFields_pass0, "VAL")
}



#OPI timeouts
#<<<--- add_time("OpeningTimeThreshold",       PV_DESC="Maximum Opening Time")
record(ai, "Spk-130SHC:Cryo-PV-55091:OpeningTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeThreshold",       PV_DESC="Maximum Closing Time")
record(ai, "Spk-130SHC:Cryo-PV-55091:ClosingTimeThreshold")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Maximum Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeThreshold")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("OpeningTimeElapsed",         PV_DESC="Elapsed Opening Time")
record(ai, "Spk-130SHC:Cryo-PV-55091:OpeningTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Opening Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "OpeningTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_time("ClosingTimeElapsed",         PV_DESC="Elapsed Closing Time")
record(ai, "Spk-130SHC:Cryo-PV-55091:ClosingTimeElapsed")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Elapsed Closing Time")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "ClosingTimeElapsed")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_time("SolPulseDuration",           PV_DESC="Solenoid Pulse Duration")
record(ai, "Spk-130SHC:Cryo-PV-55091:SolPulseDuration")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Solenoid Pulse Duration")
	field(EGU,  "ms")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "SolPulseDuration")
	info(autosaveFields_pass0, "VAL")
}



############################
#COMMAND BLOCK
############################
#<<<--- define_command_block()

##########
########## Spk-130SHC:Cryo-PV-55091 EPICS -> PLC commands   ##########
##########

#OPI buttons
#<<<--- add_digital("Cmd_Auto",                PV_DESC="CMD: Auto Mode")
record(bo, "Spk-130SHC:Cryo-PV-55091:Cmd_Auto")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Auto Mode")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Auto")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_Manual",              PV_DESC="CMD: Manual Mode")
record(bo, "Spk-130SHC:Cryo-PV-55091:Cmd_Manual")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Mode")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_Manual")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuOpen",            PV_DESC="CMD: Manual Open")
record(bo, "Spk-130SHC:Cryo-PV-55091:Cmd_ManuOpen")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Open")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuOpen")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_ManuClose",           PV_DESC="CMD: Manual Close")
record(bo, "Spk-130SHC:Cryo-PV-55091:Cmd_ManuClose")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Manual Close")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ManuClose")
	info(autosaveFields_pass0, "VAL")
}



#<<<--- add_digital("Cmd_AckAlarm",            PV_DESC="CMD: Acknowledge Alarm")
record(bo, "Spk-130SHC:Cryo-PV-55091:Cmd_AckAlarm")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Acknowledge Alarm")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_AckAlarm")
	info(autosaveFields_pass0, "VAL")
}


#<<<--- add_digital("Cmd_ForceUnlock",         PV_DESC="CMD: Force Unlock Device")
record(bo, "Spk-130SHC:Cryo-PV-55091:Cmd_ForceUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Force Unlock Device")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_ForceUnlock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevLock",             PV_DESC="CMD: Lock Device")
record(bo, "Spk-130SHC:Cryo-PV-55091:Cmd_DevLock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Lock Device")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevLock")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_digital("Cmd_DevUnlock",           PV_DESC="CMD: Unlock Device")
record(bo, "Spk-130SHC:Cryo-PV-55091:Cmd_DevUnlock")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "CMD: Unlock Device")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "Cmd_DevUnlock")
	info(autosaveFields_pass0, "VAL")
}


############################
#PARAMETER BLOCK
############################
#<<<--- define_parameter_block()

##########
########## Spk-130SHC:Cryo-PV-55091 EPICS -> PLC parameters ##########
##########

#Locking mechanism
#<<<--- add_analog("P_Faceplate_LockID",       "DINT",                          PV_DESC="Device ID after Lock")
record(ao, "Spk-130SHC:Cryo-PV-55091:P_Faceplate_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Lock")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_Faceplate_LockID")
	info(autosaveFields_pass0, "VAL")
}

#<<<--- add_analog("P_BlockIcon_LockID",       "DINT",                          PV_DESC="Device ID after Blockicon Open")
record(ao, "Spk-130SHC:Cryo-PV-55091:P_BlockIcon_LockID")
{
	field(DISS, "INVALID")
	field(DISV, "0")
	field(SDIS, "CrS-C3S:Ctrl-PLC-01:PLCHashCorrectR CP")
	field(DESC, "Device ID after Blockicon Open")
	field(DRVH, "2147483647")
	field(DRVL, "-2147483648")
	info("plc_datablock", "DEV_Spk-130SHC:Cryo-PV-55091_iDB")
	info("plc_variable", "P_BlockIcon_LockID")
	info(autosaveFields_pass0, "VAL")
}

record(fanout, "Spk-130SHC:Cryo-PV-55091:UploadParametersS") {
	field(LNK1, "Spk-130SHC:Cryo-PV-55091:P_Faceplate_LockID")
	field(LNK2, "Spk-130SHC:Cryo-PV-55091:P_BlockIcon_LockID")
}


